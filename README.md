Google Universal Analytics.js tracking code for SilverStripe 3
==============================================================

Extension to add Google **Universal Analytics.js** tracking code (`ga()`) to your SilverStripe templates.

**Note:** This requires an [upgrade of your Google Analytics account](https://developers.google.com/analytics/devguides/collection/upgrade/)
if it is still running with an older setup, and is **not** compatible with the older `_gaq` code (though you may run them simultaneously).
Please see the official [Google Universal Analytics](https://developers.google.com/analytics/devguides/collection/analyticsjs/)
site for more information.

It includes tracking for all external links & "assets" downloads using "events" in Google Analytics (optional).

## Features
* Google Universal Analytics `Analytics.js` code injected into automatically `<head>` of page to prevent JavaScript conflicts due to
loading order (if you are using custom `ga()` functions in your other code).
* Automated `pageview` tracking for all configured accounts, including tracking of 404 & 500 page errors (tracked as
"Page Not Found" / "Page Error" events).
* Unobtrustive oubound & download link tracking - attaches to `document.body.onclick` and monitors all page clicks, rather than
on page load (ie: works with links including those generated by Ajax etc on the page after page load).
  * File downloads (all non-images in the assets folder) are tracked as "Downloads" events.
  * Outgoing links are tracked as "Outgoing Links" events.
  * Uses GA callback for tracking for both outgoing links and downloads to register before load (ie: when no `target` is set).
* Tracking codes are automatically changed to "`UA-DEV-[1+]`" if `SS_ENVIRONMENT_TYPE` is not live, or if page URL matches ?flush=
to prevent bad data capture.
* Adds the GA "nonInteraction" flag to outgoing links that open in new window (`target`) as well as downloads to not impact your bounce rate.

## Notes
* Only tracking of "left mouse clicks" works. Tracking is bypassed is the user right-clicks on a link and selects an action from the context menu
(open in new tab, save as etc...). Unfortunately there seems to be no way around this.
* All clicks on outbound links that open in a new window (`target`) are not considered bounces as your page remains open in the previous window.
Only external links that open in the same window get counted towards the bounce rate.

## Requirements
* SilverStripe 3+

## Usage
The extension is automatically loaded if you provide at least one tracking account in your `mysite/_config.php`

```php
AnalyticsJS::add_ga('create', 'UA-1234567-1', 'auto');
```

The syntax is very similar to the official documentation, so things like secondary trackers or other
configurations can be passed as follows:

```php
// Add main tracker
AnalyticsJS::add_ga('create', 'UA-1234567-1', 'auto');

// Add a secondary tracker
AnalyticsJS::add_ga('create', 'UA-1237654-1', 'auto', array('name' => 'MyOtherTracker'));

// Require ecommerce extension
AnalyticsJS::add_ga('require', 'ecommerce', 'ecommerce.js');

// Force tracking to use SSL
AnalyticsJS::add_ga('set', 'forceSSL', true);

// Disable link tracking
AnalyticsJS::$track_links = false;
```

To start live tracking, make sure your website is in `live` mode

```php
define('SS_ENVIRONMENT_TYPE', 'live');
```